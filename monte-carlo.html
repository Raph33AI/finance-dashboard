<!DOCTYPE html>
<html lang='fr'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <title>Monte Carlo Simulation - Raphael NARDONE</title>
    
    <!-- Highcharts -->
    <script src='https://code.highcharts.com/highcharts.js'></script>
    <script src='https://code.highcharts.com/modules/exporting.js'></script>
    
    <!-- Font Awesome -->
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css'>
    
    <!-- Styles -->
    <link rel='stylesheet' href='assets/css/common.css'>
    <link rel='stylesheet' href='assets/css/sidebar.css'>
    <link rel='stylesheet' href='assets/css/monte-carlo.css'>
</head>
<body>
    <div class='layout-wrapper'>
        
        <!-- ============================================
             SIDEBAR NAVIGATION
             ============================================ -->
        <aside class='sidebar' id='sidebar'>
            <div class='sidebar-header'>
                <h2><i class='fas fa-chart-line'></i> Finance Hub</h2>
                <button class='sidebar-toggle' id='sidebarToggle'>
                    <i class='fas fa-bars'></i>
                </button>
            </div>
            
            <nav class='sidebar-nav'>
                <!-- Budget Section -->
                <div class='nav-section'>
                    <button class='nav-folder'>
                        <i class='fas fa-wallet'></i>
                        <span>Budget</span>
                        <i class='fas fa-chevron-down arrow'></i>
                    </button>
                    <div class='nav-submenu'>
                        <a href='index.html' class='nav-link'>
                            <i class='fas fa-home'></i>
                            <span>Dashboard Budget</span>
                        </a>
                    </div>
                </div>
                
                <!-- Simulation Section -->
                <div class='nav-section active'>
                    <button class='nav-folder active'>
                        <i class='fas fa-calculator'></i>
                        <span>Simulation</span>
                        <i class='fas fa-chevron-down arrow'></i>
                    </button>
                    <div class='nav-submenu' style='display: block;'>
                        <a href='monte-carlo.html' class='nav-link active'>
                            <i class='fas fa-dice'></i>
                            <span>Monte Carlo</span>
                        </a>
                        <a href='portfolio-optimizer.html' class='nav-link'>
                            <i class='fas fa-chart-pie'></i>
                            <span>Markowitz</span>
                        </a>
                        <a href='risk-parity.html' class='nav-link'>
                            <i class='fas fa-balance-scale'></i>
                            <span>Risk Parity</span>
                        </a>
                        <a href='scenario-analysis.html' class='nav-link'>
                            <i class='fas fa-flask'></i>
                            <span>Scénarios</span>
                        </a>
                    </div>
                </div>
                
                <!-- Stocks Section -->
                <div class='nav-section'>
                    <button class='nav-folder'>
                        <i class='fas fa-chart-line'></i>
                        <span>Stocks</span>
                        <i class='fas fa-chevron-down arrow'></i>
                    </button>
                    <div class='nav-submenu'>
                        <a href='market-data.html' class='nav-link'>
                            <i class='fas fa-globe'></i>
                            <span>Market Data</span>
                        </a>
                    </div>
                </div>
            </nav>
            
            <!-- Sidebar Footer - Version avec authentification -->
            <div class="sidebar-footer">
                <div class="user-info" id="userInfoSection">
                    <!-- État non connecté -->
                    <button class="user-profile-btn" id="userProfileBtn" aria-label="Accéder à mon profil">
                        <i class="fas fa-user-circle"></i>
                        <div class="user-details">
                            <span class="user-name">Connexion</span>
                            <span class="user-status">Cliquez pour vous connecter</span>
                        </div>
                        <i class="fas fa-chevron-right arrow-icon"></i>
                    </button>
                </div>
            </div>
        </aside>
        
        <!-- ============================================
             MAIN CONTENT AREA
             ============================================ -->
        <div class='main-content'>
            <!-- Top Header -->
            <header class='top-header'>
                <div class="header-content-wrapper"> <!-- ✅ NOUVEAU WRAPPER -->
                    <div class='header-left'>
                        <button class='mobile-toggle' id='mobileToggle'>
                            <i class='fas fa-bars'></i>
                        </button>
                        <h1>Monte Carlo Simulation</h1> <!-- N'oubliez pas de changer ce titre pour chaque page -->
                    </div>
                    <div class='header-right'>
                        <span class='last-update'>
                            <i class='fas fa-clock'></i>
                            <span id='lastUpdate'></span>
                        </span>
                    </div>
                </div> <!-- ✅ FIN DU NOUVEAU WRAPPER -->
            </header>
            
            <!-- Container -->
            <div class='container'>
                <!-- Main Content -->
                <div class='content'>
                    <!-- Parameters Panel -->
                    <div class='params-panel'>
                        <h2 class='panel-title'>
                            Simulation Parameters 
                            <span class='help-icon' onclick='openModal("modalMCIntro")'>?</span>
                        </h2>
                        
                        <div class='params-grid'>
                            <div class='param-group'>
                                <label for='monthlyInvestment'>
                                    Monthly Investment (EUR) 
                                    <span class='help-icon help-icon-small' onclick='openModal("modalMCInvest")'>?</span>
                                </label>
                                <input type='number' id='monthlyInvestment' value='200' step='10'>
                                <div class='hint'>Amount invested each month</div>
                            </div>
                            
                            <div class='param-group'>
                                <label for='monthlyYield'>
                                    Est. Monthly Yield (%) 
                                    <span class='help-icon help-icon-small' onclick='openModal("modalMCYield")'>?</span>
                                </label>
                                <input type='number' id='monthlyYield' value='0.67' step='0.01'>
                                <div class='hint'>Expected monthly return (e.g., 0.67 = 0.67%)</div>
                            </div>
                            
                            <div class='param-group'>
                                <label for='volatility'>
                                    Volatility (%) 
                                    <span class='help-icon help-icon-small' onclick='openModal("modalMCVol")'>?</span>
                                </label>
                                <input type='number' id='volatility' value='15' step='0.5'>
                                <div class='hint'>Market volatility (e.g., 15 = 15%)</div>
                            </div>
                            
                            <div class='param-group'>
                                <label for='years'>Projection Horizon (Years)</label>
                                <input type='number' id='years' value='25' step='1' min='1'>
                                <div class='hint'>Number of years to simulate</div>
                            </div>
                            
                            <div class='param-group'>
                                <label for='simulations'>
                                    Number of Simulations 
                                    <span class='help-icon help-icon-small' onclick='openModal("modalMCSim")'>?</span>
                                </label>
                                <input type='number' id='simulations' value='1000' step='100' min='100'>
                                <div class='hint'>More = more accurate (slower)</div>
                            </div>
                            
                            <div class='param-group'>
                                <label for='targetValue'>Target Portfolio Value (EUR)</label>
                                <input type='number' id='targetValue' value='100000' step='1000'>
                                <div class='hint'>Goal to reach (for time analysis)</div>
                            </div>
                            
                            <div class='param-group'>
                                <label for='inflationRateMC'>Annual Inflation Rate (%)</label>
                                <input type='number' id='inflationRateMC' value='2.5' step='0.1'>
                                <div class='hint'>Expected annual inflation (e.g., 2.5%)</div>
                            </div>
                        </div>
                        
                        <div class='inflation-toggle'>
                            <label>
                                <input type='checkbox' id='showInflationMC'>
                                Show Inflation-Adjusted Values (Real Returns)
                            </label>
                        </div>
                        
                        <button class='btn-simulate' onclick='MonteCarlo.runSimulation()'>Run Simulation</button>
                    </div>
                    
                    <!-- Results Panel -->
                    <div id='resultsPanel' class='results-panel hidden'>
                        <h2 class='section-title'>
                            Simulation Results 
                            <span class='help-icon' onclick='openModal("modalMCResults")'>?</span>
                        </h2>
                        
                        <h3 class='subsection-title'>Final Portfolio Value</h3>
                        <div id='statsContainer' class='stats-grid'></div>
                        
                        <h3 class='subsection-title'>Portfolio Evolution Over Time</h3>
                        <div id='chart1' class='chart'></div>
                        
                        <div class='charts-grid-2'>
                            <div>
                                <h3 class='subsection-title'>Distribution of Final Returns</h3>
                                <div id='chart2' class='chart chart-medium'></div>
                            </div>
                            <div>
                                <h3 class='subsection-title'>Probability Analysis</h3>
                                <div id='chart3' class='chart chart-medium'></div>
                            </div>
                        </div>
                        
                        <h3 class='subsection-title'>
                            Risk Analysis 
                            <span class='help-icon' onclick='openModal("modalMCRisk")'>?</span>
                        </h3>
                        <div id='riskAnalysis' class='stats-grid'></div>
                        
                        <h3 class='subsection-title'>Stress Testing Scenarios</h3>
                        <div id='chart4' class='chart'></div>
                        
                        <h3 class='subsection-title'>Time to Target</h3>
                        <div id='chart5' class='chart'></div>
                    </div>
                </div>
                
                <!-- Footer -->
                <footer>
                    <p>Monte Carlo Simulation | Generated with advanced stochastic modeling</p>
                </footer>
            </div>
        </div>
        
    </div>
    
    <!-- ============================================
         MODALS
         ============================================ -->
    <div id='modalMCIntro' class='modal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>🎲 What is Monte Carlo Simulation?</h2>
                <span class='close-modal' onclick='closeModal("modalMCIntro")'>&times;</span>
            </div>
            <div class='modal-body'>
                <h3>📊 Purpose</h3>
                <p>Monte Carlo simulation uses <strong>random sampling</strong> to model the uncertainty in investment returns. Instead of a single projection, it generates <strong>thousands of possible scenarios</strong> to show the range of potential outcomes.</p>
                
                <h3>⚙️ How It Works</h3>
                <ol>
                    <li><strong>Random Returns:</strong> Each month, the simulation generates a random return based on your expected yield and volatility</li>
                    <li><strong>Compounding:</strong> Returns accumulate over time with monthly investments added</li>
                    <li><strong>Repetition:</strong> This process repeats 1,000+ times to create a distribution of outcomes</li>
                    <li><strong>Analysis:</strong> Statistical analysis reveals probabilities (e.g., 90% chance of reaching X amount)</li>
                </ol>
                
                <div class='formula-box'>
                    <strong>Formula (each month):</strong><br>
                    Portfolio<sub>month</sub> = Portfolio<sub>previous</sub> × (1 + Return<sub>random</sub>) + MonthlyInvestment<br><br>
                    Return<sub>random</sub> ~ Normal(µ, σ)
                </div>
                
                <h3>✅ Key Advantages</h3>
                <ul>
                    <li><strong>Realistic:</strong> Captures market volatility and uncertainty</li>
                    <li><strong>Probabilistic:</strong> Shows likelihood of outcomes (not just one forecast)</li>
                    <li><strong>Risk-aware:</strong> Identifies worst-case and best-case scenarios</li>
                    <li><strong>Actionable:</strong> Helps adjust strategy based on confidence levels</li>
                </ul>
                
                <div class='tip-box'>
                    💡 <strong>Pro Tip:</strong> The median (50th percentile) is more reliable than the average for long-term projections, as it's less affected by extreme outliers.
                </div>
            </div>
        </div>
    </div>
    
    <div id='modalMCInvest' class='modal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>💰 Monthly Investment Strategy</h2>
                <span class='close-modal' onclick='closeModal("modalMCInvest")'>&times;</span>
            </div>
            <div class='modal-body'>
                <h3>📈 What Is Dollar-Cost Averaging (DCA)?</h3>
                <p>Investing a <strong>fixed amount regularly</strong> (e.g., 200 EUR/month) regardless of market conditions.</p>
                
                <h3>✅ Advantages</h3>
                <ul>
                    <li><strong>Reduces timing risk:</strong> You buy more when prices are low, less when high</li>
                    <li><strong>Discipline:</strong> Automates investing, removes emotions</li>
                    <li><strong>Accessible:</strong> No need for large lump sum</li>
                    <li><strong>Compound growth:</strong> Early investments grow the longest</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div id='modalMCYield' class='modal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>📊 Expected Monthly Yield</h2>
                <span class='close-modal' onclick='closeModal("modalMCYield")'>&times;</span>
            </div>
            <div class='modal-body'>
                <h3>📐 Definition</h3>
                <p>The <span class='key-term'>Expected Yield</span> is the average return you anticipate <strong>per month</strong>. It's the central tendency around which random returns fluctuate.</p>
                
                <div class='formula-box'>
                    <strong>Conversion Formula:</strong><br>
                    Monthly Yield = (1 + Annual Return)<sup>1/12</sup> - 1<br><br>
                    <strong>Approximation:</strong><br>
                    Monthly Yield ≈ Annual Return / 12
                </div>
            </div>
        </div>
    </div>
    
    <div id='modalMCVol' class='modal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>📉 Understanding Volatility</h2>
                <span class='close-modal' onclick='closeModal("modalMCVol")'>&times;</span>
            </div>
            <div class='modal-body'>
                <h3>📊 Definition</h3>
                <p><span class='key-term'>Volatility</span> measures how much returns fluctuate around the average. High volatility = big swings up and down. Low volatility = stable returns.</p>
                
                <h3>📈 Typical Values (Annual)</h3>
                <ul>
                    <li><strong>Cash/Bonds:</strong> 2-6%</li>
                    <li><strong>Balanced Portfolio (60/40):</strong> 10-12%</li>
                    <li><strong>Global Stocks (S&P 500):</strong> 15-20%</li>
                    <li><strong>Cryptocurrencies:</strong> 60-100%+</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div id='modalMCSim' class='modal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>🔢 Number of Simulations</h2>
                <span class='close-modal' onclick='closeModal("modalMCSim")'>&times;</span>
            </div>
            <div class='modal-body'>
                <h3>🎯 Why Multiple Simulations?</h3>
                <p>Each simulation is one possible future. Running many simulations creates a <strong>probability distribution</strong> of outcomes, giving you confidence intervals.</p>
                
                <h3>📊 How Many Do You Need?</h3>
                <ul>
                    <li><strong>100-500:</strong> Quick test, rough estimate (±5% accuracy)</li>
                    <li><strong>1,000:</strong> Standard (±2% accuracy) → Recommended</li>
                    <li><strong>5,000:</strong> High precision (±1% accuracy)</li>
                    <li><strong>10,000+:</strong> Academic/professional use (±0.5% accuracy)</li>
                </ul>
            </div>
        </div>
    </div>
    
    <div id='modalMCResults' class='modal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>📊 How to Read Your Results</h2>
                <span class='close-modal' onclick='closeModal("modalMCResults")'>&times;</span>
            </div>
            <div class='modal-body'>
                <h3>📈 Key Metrics Explained</h3>
                
                <h4>1️⃣ Median (50th Percentile)</h4>
                <p>The <span class='key-term'>middle value</span> when all outcomes are sorted. <strong>50% of simulations are above</strong> this, 50% below.</p>
                <div class='tip-box'>💡 <strong>Use this</strong> as your most likely outcome.</div>
                
                <h4>2️⃣ 10th Percentile (Pessimistic)</h4>
                <p>Only <strong>10% of scenarios are worse</strong> than this. Think of it as a "bad luck" scenario.</p>
                
                <h4>3️⃣ 90th Percentile (Optimistic)</h4>
                <p>Only <strong>10% of scenarios are better</strong> than this. Think of it as a "good luck" scenario.</p>
            </div>
        </div>
    </div>
    
    <div id='modalMCRisk' class='modal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>⚠️ Risk Metrics Explained</h2>
                <span class='close-modal' onclick='closeModal("modalMCRisk")'>&times;</span>
            </div>
            <div class='modal-body'>
                <h3>📊 Key Risk Indicators</h3>
                
                <h4>1️⃣ Value at Risk (VaR) 5%</h4>
                <p><span class='key-term'>VaR 5%</span> = The 5th percentile outcome. <strong>95% of scenarios are better</strong> than this.</p>
                
                <h4>2️⃣ Loss Probability</h4>
                <p>% of simulations where you <strong>end up with less than you invested</strong> (no gains, or losses).</p>
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src='assets/js/common.js'></script>
    <script src='assets/js/sidebar.js'></script>
    <script src='assets/js/monte-carlo.js'></script>
</body>
</html>