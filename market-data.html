<!DOCTYPE html>
<html lang='fr'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <meta name='description' content='Market Data Dashboard - Real-time stock analysis, technical indicators, watchlist and price alerts'>
    <meta name='author' content='Raphael NARDONE'>
    <meta name='theme-color' content='#2563eb'>
    
    <title>Market Data</title>
    
    <!-- Preconnect pour optimisation -->
    <link rel='preconnect' href='https://code.highcharts.com'>
    <link rel='preconnect' href='https://cdnjs.cloudflare.com'>
    
    <!-- Highcharts - ORDRE IMPORTANT -->
    <script src='https://code.highcharts.com/stock/highstock.js' defer></script>
    <script src='https://code.highcharts.com/stock/indicators/indicators-all.js' defer></script>
    <script src='https://code.highcharts.com/stock/modules/drag-panes.js' defer></script>
    <script src='https://code.highcharts.com/modules/annotations-advanced.js' defer></script>
    <script src='https://code.highcharts.com/modules/price-indicator.js' defer></script>
    <script src='https://code.highcharts.com/modules/full-screen.js' defer></script>
    <script src='https://code.highcharts.com/modules/stock-tools.js' defer></script>
    <script src='https://code.highcharts.com/modules/exporting.js' defer></script>
    <script src='https://code.highcharts.com/modules/export-data.js' defer></script>
    <script src='https://code.highcharts.com/modules/accessibility.js' defer></script>
    
    <!-- Font Awesome -->
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css' integrity='sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==' crossorigin='anonymous' referrerpolicy='no-referrer'>
    
    <!-- Styles -->
    <link rel='stylesheet' href='assets/css/common.css'>
    <link rel='stylesheet' href='assets/css/sidebar.css'>
    <link rel="stylesheet" href="assets/css/user-menu.css">
    <link rel='stylesheet' href='assets/css/market-data.css'>
    <link rel='stylesheet' href='assets/css/cache-widget.css'>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Configuration Firebase -->
    <script src="assets/js/firebase-config.js"></script>
    
    <!-- Protection de la page (AUTH GUARD) -->
    <script src="assets/js/auth-guard.js"></script>
</head>
<body>

    <!-- ‚ö° THEME SCRIPT - DOIT √äTRE CHARG√â EN PREMIER -->
    <script src="assets/js/theme.js"></script>

    <!-- üé® THEME CHARTS - POUR LES GRAPHIQUES -->
    <script src="assets/js/theme-charts.js"></script>

    <div class='layout-wrapper'>
        
        <!-- Sidebar Navigation -->
        <aside class='sidebar' id='sidebar'>
            <!-- Header -->
            <div class='sidebar-header'>
                <h2><i class='fas fa-chart-line'></i> Finance Hub</h2>
                <button class='sidebar-toggle' id='sidebarToggle'>
                    <i class='fas fa-bars'></i>
                </button>
            </div>
            
            <!-- Navigation -->
            <nav class='sidebar-nav'>
                <!-- ‚úÖ Landing Page / Accueil -->
                <div class='nav-section'>
                    <a href='index.html' class='nav-link'>
                        <i class='fas fa-rocket'></i>
                        <span>Home</span>
                    </a>
                </div>
                
                <!-- ‚úÖ Budget Section -->
                <div class='nav-section'>
                    <button class='nav-folder active'>
                        <i class='fas fa-wallet'></i>
                        <span>Budget</span>
                        <i class='fas fa-chevron-down arrow'></i>
                    </button>
                    <div class='nav-submenu' style='display: block;'>
                        <a href='dashboard-financier.html' class='nav-link'>
                            <i class='fas fa-home'></i>
                            <span>Dashboard Budget</span>
                        </a>
                        <a href='investment-analytics.html' class='nav-link'>
                            <i class='fas fa-chart-bar'></i>
                            <span>Investment Analytics</span>
                        </a>
                    </div>
                </div>
                
                <!-- ‚úÖ Simulation Section -->
                <div class='nav-section'>
                    <button class='nav-folder'>
                        <i class='fas fa-calculator'></i>
                        <span>Simulation</span>
                        <i class='fas fa-chevron-down arrow'></i>
                    </button>
                    <div class='nav-submenu'>
                        <a href='monte-carlo.html' class='nav-link'>
                            <i class='fas fa-dice'></i>
                            <span>Monte Carlo</span>
                        </a>
                        <a href='portfolio-optimizer.html' class='nav-link'>
                            <i class='fas fa-chart-pie'></i>
                            <span>Markowitz</span>
                        </a>
                        <a href='risk-parity.html' class='nav-link'>
                            <i class='fas fa-balance-scale'></i>
                            <span>Risk Parity</span>
                        </a>
                        <a href='scenario-analysis.html' class='nav-link'>
                            <i class='fas fa-flask'></i>
                            <span>Scenarios</span>
                        </a>
                    </div>
                </div>
                
                <!-- ‚úÖ Stocks Section -->
                <div class='nav-section'>
                    <button class='nav-folder'>
                        <i class='fas fa-chart-candlestick'></i>
                        <span>Stocks</span>
                        <i class='fas fa-chevron-down arrow'></i>
                    </button>
                    <div class='nav-submenu'>
                        <a href='market-data.html' class='nav-link'>
                            <i class='fas fa-database'></i>
                            <span>Market Data</span>
                        </a>
                        <a href='advanced-analysis.html' class='nav-link'>
                            <i class='fas fa-brain'></i>
                            <span>Advanced Analysis</span>
                        </a>
                        <a href='trend-prediction.html' class='nav-link'>
                            <i class='fas fa-chart-line'></i>
                            <span>Trend Prediction</span>
                        </a>
                    </div>
                </div>
            </nav>
            
            <!-- ===== SIDEBAR FOOTER - MENU UTILISATEUR ===== -->
            <div class="sidebar-footer">
                <div class="sidebar-user-menu">
                    <!-- Trigger (√©l√©ment cliquable) -->
                    <div class="sidebar-user-trigger" id="sidebarUserTrigger">
                        <img data-user-photo 
                            src="https://ui-avatars.com/api/?name=User&background=2563eb&color=fff" 
                            alt="Avatar" 
                            class="sidebar-user-avatar">
                        <div class="sidebar-user-info">
                            <span data-user-name class="sidebar-user-name">User</span>
                            <span data-user-plan class="sidebar-user-plan">Free Plan</span>
                        </div>
                        <i class="fas fa-chevron-up sidebar-user-arrow"></i>
                    </div>
                    
                    <!-- Dropdown (s'ouvre vers le haut) -->
                    <div class="sidebar-user-dropdown" id="sidebarUserDropdown">
                        <div class="user-dropdown-header">
                            <img data-user-photo 
                                src="https://ui-avatars.com/api/?name=User&background=2563eb&color=fff" 
                                alt="Avatar" 
                                class="user-dropdown-avatar">
                            <div class="user-dropdown-details">
                                <h4 data-user-name class="user-dropdown-name">User</h4>
                                <p data-user-email class="user-dropdown-email">email@example.com</p>
                            </div>
                        </div>
                        
                        <div class="user-dropdown-divider"></div>
                        
                        <nav class="user-dropdown-links">
                            <a href="user-profile.html" class="user-dropdown-link">
                                <i class="fas fa-user"></i>
                                <span>My profile</span>
                            </a>
                            <a href="settings.html" class="user-dropdown-link">
                                <i class="fas fa-cog"></i>
                                <span>Settings</span>
                            </a>
                            <a href="#" class="user-dropdown-link">
                                <i class="fas fa-question-circle"></i>
                                <span>Help</span>
                            </a>
                        </nav>
                        
                        <div class="user-dropdown-divider"></div>
                        
                        <button onclick="logout()" class="user-dropdown-logout">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Disconnect</span>
                        </button>
                    </div>
                </div>
            </div>
            <!-- ===== FIN SIDEBAR FOOTER ===== -->
        </aside>
        
        <!-- Sidebar Overlay (mobile) -->
        <div class='sidebar-overlay' id='sidebarOverlay' aria-hidden='true'></div>
        
        <!-- ============================================
             MAIN CONTENT AREA
             ============================================ -->
        <main class='main-content' role='main'>
            <!-- Top Header -->
            <header class='top-header'>
                <div class="header-content-wrapper">
                    <div class='header-left'>
                        <button class='mobile-toggle' id='mobileToggle' aria-label='Toggle navigation menu' aria-expanded='false'>
                            <i class='fas fa-bars' aria-hidden='true'></i>
                        </button>
                        <h1>Market Data</h1>
                    </div>
                    <div class='header-right'>
                        <span class='last-update' aria-live='polite'>
                            <i class='fas fa-clock' aria-hidden='true'></i>
                            <span id='lastUpdate'>Loading...</span>
                        </span>
                    </div>
                </div>
            </header>
            
            <!-- Container -->
            <div class='container'>
                <!-- Main Content -->
                <div class='content'>
                    
                    <!-- ===== üÜï PORTFOLIO MANAGEMENT SECTION ===== -->
                    <section class='card portfolio-management-section' aria-labelledby='portfolio-title'>
                        <div class='card-header'>
                            <h2 class='card-title' id='portfolio-title'>
                                <i class='fas fa-briefcase' aria-hidden='true'></i> Portfolio Management
                            </h2>
                        </div>
                        
                        <div class='card-body'>
                            <div class='toolbar simulation-management'>
                                <div class='current-simulation-display'>
                                    <span class='label'>
                                        <i class='fas fa-folder-open'></i> Current portfolio:
                                    </span>
                                    <span class='value' id='currentPortfolioName'>default</span>
                                </div>
                                
                                <div class='toolbar-row' style='justify-content: center; gap: 10px; flex-wrap: wrap; margin-top: 15px;'>
                                    <button class='btn btn-success' onclick='PortfolioManager.createNewPortfolio()'>
                                        <i class='fas fa-plus-circle'></i> New Portfolio
                                    </button>
                                    <button class='btn btn-primary' onclick='MarketData.saveCurrentPortfolio()'>
                                        <i class='fas fa-cloud-upload-alt'></i> Save Current
                                    </button>
                                    <button class='btn btn-secondary' onclick='document.getElementById("portfoliosModal").classList.add("active")'>
                                        <i class='fas fa-list'></i> Manage Portfolios
                                    </button>
                                    <button class='btn btn-secondary' onclick='MarketData.exportPortfolioJSON()'>
                                        <i class='fas fa-file-export'></i> Export JSON
                                    </button>
                                    <button class='btn btn-secondary' onclick='MarketData.importPortfolioJSON()'>
                                        <i class='fas fa-file-import'></i> Import JSON
                                    </button>
                                </div>
                            </div>
                            
                            <!-- ‚úÖ CORRIG√â : Texte blanc forc√© -->
                            <div class='info-box info-box-white-text' style='margin-top: 1rem;'>
                                <h4><i class='fas fa-info-circle'></i> How it works</h4>
                                <p>Create multiple portfolios to organize your watchlists, alerts, and stock comparisons. All portfolios are automatically saved to the cloud and accessible from any device.</p>
                            </div>
                        </div>
                    </section>
                    <!-- ===== FIN PORTFOLIO MANAGEMENT ===== -->
                    
                    <!-- Search Panel -->
                    <section class='search-panel card' aria-labelledby='search-title'>
                        <div class='card-header'>
                            <h2 class='card-title' id='search-title'>
                                <i class='fas fa-search' aria-hidden='true'></i> Search Stock for Market Data
                            </h2>
                            <button class='help-icon' onclick='openModal("modalSearchHelp")' aria-label='Help about searching stocks'>?</button>
                        </div>
                        
                        <div class='card-body'>
                            <div class='search-container'>
                                <!-- Search Input + Button -->
                                <div class='search-input-wrapper'>
                                    <label for='symbolInput' class='sr-only'>Stock symbol or company name</label>
                                    <input type='text' 
                                        id='symbolInput' 
                                        class='form-input'
                                        placeholder='Search by symbol or company name (e.g., AAPL, Apple, Tesla)...'
                                        autocomplete='off'
                                        value='AAPL'
                                        aria-describedby='search-instructions'>
                                    <button class='btn btn-primary btn-search' onclick='MarketData.searchStock()' aria-label='Analyze selected stock'>
                                        <i class='fas fa-chart-area' aria-hidden='true'></i> Analyze Stock
                                    </button>
                                    
                                    <!-- Suggestions dropdown -->
                                    <div class='search-suggestions' id='searchSuggestions' role='listbox' aria-label='Search suggestions'></div>
                                </div>
                                
                                <span id='search-instructions' class='sr-only'>Type to search for stocks. Use arrow keys to navigate suggestions, Enter to select.</span>
                                
                                <!-- Popular Stocks -->
                                <div class='popular-stocks'>
                                    <span class='quick-label'>Popular Stocks:</span>
                                    <button class='symbol-chip' onclick='MarketData.loadSymbol("AAPL")' aria-label='Load Apple stock'>
                                        <i class='fab fa-apple' aria-hidden='true'></i> AAPL
                                    </button>
                                    <button class='symbol-chip' onclick='MarketData.loadSymbol("MSFT")' aria-label='Load Microsoft stock'>
                                        <i class='fab fa-microsoft' aria-hidden='true'></i> MSFT
                                    </button>
                                    <button class='symbol-chip' onclick='MarketData.loadSymbol("GOOGL")' aria-label='Load Google stock'>
                                        <i class='fab fa-google' aria-hidden='true'></i> GOOGL
                                    </button>
                                    <button class='symbol-chip' onclick='MarketData.loadSymbol("TSLA")' aria-label='Load Tesla stock'>
                                        <i class='fas fa-car' aria-hidden='true'></i> TSLA
                                    </button>
                                    <button class='symbol-chip' onclick='MarketData.loadSymbol("BTC-USD")' aria-label='Load Bitcoin price'>
                                        <i class='fab fa-bitcoin' aria-hidden='true'></i> BTC-USD
                                    </button>
                                    <button class='symbol-chip' onclick='MarketData.loadSymbol("^GSPC")' aria-label='Load S&P 500 index'>
                                        <i class='fas fa-chart-line' aria-hidden='true'></i> S&P 500
                                    </button>
                                </div>
                                
                                <!-- Period Selection -->
                                <div class='time-period-selector' role='group' aria-labelledby='period-label'>
                                    <label id='period-label'>Time Period:</label>
                                    <button class='period-btn active' data-period='1M' onclick='MarketData.changePeriod("1M")' aria-pressed='true'>1M</button>
                                    <button class='period-btn' data-period='3M' onclick='MarketData.changePeriod("3M")' aria-pressed='false'>3M</button>
                                    <button class='period-btn' data-period='6M' onclick='MarketData.changePeriod("6M")' aria-pressed='false'>6M</button>
                                    <button class='period-btn' data-period='1Y' onclick='MarketData.changePeriod("1Y")' aria-pressed='false'>1Y</button>
                                    <button class='period-btn' data-period='5Y' onclick='MarketData.changePeriod("5Y")' aria-pressed='false'>5Y</button>
                                    <button class='period-btn' data-period='MAX' onclick='MarketData.changePeriod("MAX")' aria-pressed='false'>MAX</button>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Stock Comparison Section -->
                    <section class='comparison-section card' aria-labelledby='comparison-title'>
                        <div class='card-header comparison-header'>
                            <h2 class='card-title' id='comparison-title'>
                                <i class='fas fa-chart-bar' aria-hidden='true'></i> Stock Comparison
                            </h2>
                            <div class='comparison-actions'>
                                <button class='btn btn-primary btn-compare' onclick='MarketData.openComparisonModal()'>
                                    <i class='fas fa-plus' aria-hidden='true'></i> Add Stocks to Compare
                                    </button>
                                <button class='btn btn-danger btn-clear-comparison' onclick='MarketData.clearComparison()'>
                                    <i class='fas fa-trash' aria-hidden='true'></i> Clear All
                                </button>
                            </div>
                        </div>
                        
                        <div class='card-body'>
                            <div id='comparisonContainer' class='comparison-container hidden'>
                                <!-- Selected stocks chips -->
                                <div class='comparison-stocks' id='comparisonStocks' role='list' aria-label='Stocks being compared'></div>
                                
                                <!-- Comparison Chart -->
                                <div class='comparison-chart-wrapper'>
                                    <h3 class='subsection-title'>Performance Comparison (Normalized to 100)</h3>
                                    <div id='comparisonChart' class='chart' role='img' aria-label='Stock performance comparison chart'></div>
                                </div>
                                
                                <!-- Comparison Table -->
                                <div class='comparison-table-wrapper'>
                                    <h3 class='subsection-title'>Key Metrics Comparison</h3>
                                    <div id='comparisonTable' class='comparison-table' role='region' aria-label='Comparison metrics table'></div>
                                </div>
                            </div>
                            
                            <div id='comparisonEmpty' class='comparison-empty'>
                                <i class='fas fa-chart-line' aria-hidden='true'></i>
                                <p>No stocks to compare</p>
                                <p class='hint'>Click "Add Stocks to Compare" to get started</p>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Watchlist Section -->
                    <section class='watchlist-section card' aria-labelledby='watchlist-title'>
                        <div class='card-header watchlist-header'>
                            <h2 class='card-title' id='watchlist-title'>
                                <i class='fas fa-star' aria-hidden='true'></i> My Watchlist
                            </h2>
                            <div class='watchlist-actions'>
                                <button class='btn btn-success btn-add-current' onclick='MarketData.addCurrentToWatchlist()' id='btnAddCurrent' disabled>
                                    <i class='fas fa-plus' aria-hidden='true'></i> Add Current Stock
                                </button>
                                <button class='btn btn-primary btn-refresh-watchlist' onclick='MarketData.refreshWatchlist()'>
                                    <i class='fas fa-sync-alt' aria-hidden='true'></i> Refresh All
                                </button>
                                <button class='btn btn-danger btn-clear-watchlist' onclick='MarketData.clearWatchlist()'>
                                    <i class='fas fa-trash' aria-hidden='true'></i> Clear All
                                </button>
                            </div>
                        </div>
                        
                        <div class='card-body'>
                            <div id='watchlistContainer' class='watchlist-container' role='list' aria-label='Watchlist stocks'>
                                <div class='watchlist-empty'>
                                    <i class='fas fa-star-half-alt' aria-hidden='true'></i>
                                    <p>Your watchlist is empty</p>
                                    <p class='hint'>Search for a stock and click "Add to Watchlist" to start tracking</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Price Alerts Section -->
                    <section class='alerts-section card' aria-labelledby='alerts-title'>
                        <div class='card-header alerts-header'>
                            <h2 class='card-title' id='alerts-title'>
                                <i class='fas fa-bell' aria-hidden='true'></i> Price Alerts
                            </h2>
                            <button class='btn btn-accent btn-create-alert' onclick='MarketData.openAlertModal()'>
                                <i class='fas fa-plus' aria-hidden='true'></i> Create Alert
                            </button>
                        </div>
                        
                        <div class='card-body'>
                            <div id='alertsContainer' class='alerts-container' role='list' aria-label='Active price alerts'>
                                <div class='alerts-empty'>
                                    <i class='fas fa-bell-slash' aria-hidden='true'></i>
                                    <p>No active alerts</p>
                                    <p class='hint'>Create price alerts to get notified when a stock reaches your target</p>
                                </div>
                            </div>
                        </div>
                    </section>
                    
                    <!-- Loading Indicator -->
                    <div id='loadingIndicator' class='loading-indicator hidden' role='status' aria-live='polite'>
                        <i class='fas fa-spinner fa-spin' aria-hidden='true'></i> Loading market data...
                    </div>
                    
                    <!-- Stock Overview -->
                    <section id='stockOverview' class='stock-overview hidden' aria-labelledby='stock-overview-title'>
                        <div class='overview-header'>
                            <div class='stock-title'>
                                <h2 id='stockName'>-</h2>
                                <span id='stockSymbol' class='stock-symbol'>-</span>
                            </div>
                            <div class='stock-price-section'>
                                <div id='currentPrice' class='current-price' aria-label='Current stock price'>-</div>
                                <div id='priceChange' class='price-change' aria-label='Price change'>-</div>
                            </div>
                        </div>
                        
                        <div class='overview-stats' role='list' aria-label='Stock statistics'>
                            <div class='stat-item' role='listitem'>
                                <span class='stat-label'>Open</span>
                                <span id='statOpen' class='stat-value'>-</span>
                            </div>
                            <div class='stat-item' role='listitem'>
                                <span class='stat-label'>High</span>
                                <span id='statHigh' class='stat-value'>-</span>
                            </div>
                            <div class='stat-item' role='listitem'>
                                <span class='stat-label'>Low</span>
                                <span id='statLow' class='stat-value'>-</span>
                            </div>
                            <div class='stat-item' role='listitem'>
                                <span class='stat-label'>Volume</span>
                                <span id='statVolume' class='stat-value'>-</span>
                            </div>
                            <div class='stat-item' role='listitem'>
                                <span class='stat-label'>Mkt Cap</span>
                                <span id='statMarketCap' class='stat-value'>-</span>
                            </div>
                            <div class='stat-item' role='listitem'>
                                <span class='stat-label'>P/E Ratio</span>
                                <span id='statPE' class='stat-value'>-</span>
                            </div>
                        </div>
                    </section>

                    <!-- ‚úÖ CORRIG√â : Company Profile & Statistics EN ACCORD√âON COMPACT -->
                    <section id='companyProfileSection' class='company-profile-section card hidden' aria-labelledby='company-profile-title'>
                        <!-- Le contenu sera g√©n√©r√© dynamiquement par JavaScript avec des accord√©ons -->
                    </section>
                    
                    <!-- Results Panel -->
                    <section id='resultsPanel' class='results-panel card hidden' aria-labelledby='results-title'>
                        <div class='card-body'>
                            
                            <!-- Price Chart -->
                            <div class='chart-section'>
                                <h3 class='subsection-title' id='price-chart-title'>
                                    <i class='fas fa-chart-line' aria-hidden='true'></i> Price Chart with Technical Indicators
                                    <button class='help-icon' onclick='openModal("modalChartHelp")' aria-label='Help about price chart'>?</button>
                                </h3>
                                <div class='indicator-toggles' role='group' aria-label='Technical indicator toggles'>
                                    <label><input type='checkbox' id='toggleSMA' checked> SMA (20, 50)</label>
                                    <label><input type='checkbox' id='toggleEMA'> EMA (12, 26)</label>
                                    <label><input type='checkbox' id='toggleBB' checked> Bollinger Bands</label>
                                    <label><input type='checkbox' id='toggleVolume' checked> Volume</label>
                                </div>
                                <div id='priceChart' class='chart' role='img' aria-labelledby='price-chart-title'></div>
                            </div>
                            
                            <!-- Technical Indicators -->
                            <div class='charts-grid-2'>
                                <div class='chart-section'>
                                    <h3 class='subsection-title' id='rsi-title'>
                                        <i class='fas fa-wave-square' aria-hidden='true'></i> RSI (Relative Strength Index)
                                        <button class='help-icon' onclick='openModal("modalRSI")' aria-label='Help about RSI'>?</button>
                                    </h3>
                                    <div id='rsiChart' class='chart chart-medium' role='img' aria-labelledby='rsi-title'></div>
                                </div>
                                
                                <div class='chart-section'>
                                    <h3 class='subsection-title' id='macd-title'>
                                        <i class='fas fa-chart-bar' aria-hidden='true'></i> MACD (Moving Average Convergence Divergence)
                                        <button class='help-icon' onclick='openModal("modalMACD")' aria-label='Help about MACD'>?</button>
                                    </h3>
                                    <div id='macdChart' class='chart chart-medium' role='img' aria-labelledby='macd-title'></div>
                                </div>
                            </div>
                            
                            <!-- Trading Signals -->
                            <div class='signals-section'>
                                <h3 class='subsection-title' id='signals-title'>
                                    <i class='fas fa-signal' aria-hidden='true'></i> Trading Signals
                                    <button class='help-icon' onclick='openModal("modalSignals")' aria-label='Help about trading signals'>?</button>
                                </h3>
                                <div id='tradingSignals' class='signals-grid' role='list' aria-labelledby='signals-title'></div>
                            </div>
                            
                            <!-- Key Statistics -->
                            <div class='stats-section'>
                                <h3 class='subsection-title'><i class='fas fa-table' aria-hidden='true'></i> Key Statistics</h3>
                                <div id='keyStats' class='stats-grid' role='list' aria-label='Key stock statistics'></div>
                            </div>
                            
                        </div>
                    </section>
                </div>
                
                <!-- Footer -->
                <footer role='contentinfo'>
                    <p>&copy; 2024 Market Data Dashboard | Real-time financial data and technical analysis</p>
                    <p class='data-source'>Data provided by Twelve Data</p>
                </footer>
            </div>
        </main>
        
    </div>
    
    <!-- ============================================
         MODALS (TOUS LES MODALS EXISTANTS + NOUVEAUX CORRIG√âS)
         ============================================ -->
         
    <!-- ===== üÜï PORTFOLIOS MODAL ===== -->
    <div class='modal' id='portfoliosModal'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2>
                    <i class='fas fa-briefcase'></i> Manage Portfolios
                </h2>
                <button class='modal-close' onclick='document.getElementById("portfoliosModal").classList.remove("active")'>
                    <i class='fas fa-times'></i>
                </button>
            </div>
            
            <div class='modal-body'>
                <div class='simulations-info'>
                    <p>
                        <i class='fas fa-info-circle'></i> 
                        <strong>Your portfolios are stored in the cloud.</strong>
                        Create multiple portfolios with different watchlists, alerts, and comparisons. Access them from any device!
                    </p>
                </div>
                
                <div id='portfoliosListContainer'>
                    <!-- Filled dynamically by portfolio-manager.js -->
                    <div class='loading-simulations'>
                        <i class='fas fa-spinner fa-spin'></i> Loading portfolios...
                    </div>
                </div>
            </div>
            
            <div class='modal-footer'>
                <button class='btn btn-primary' onclick='PortfolioManager.createNewPortfolio()'>
                    <i class='fas fa-plus'></i> New Portfolio
                </button>
                <button class='btn btn-secondary' onclick='document.getElementById("portfoliosModal").classList.remove("active")'>
                    <i class='fas fa-times'></i> Close
                </button>
            </div>
        </div>
    </div>
    
    <!-- ‚úÖ CORRIG√â : Modal pour Add Comparison -->
    <div id='modalAddComparison' class='modal' role='dialog' aria-labelledby='comparison-modal-title' aria-modal='true'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2 id='comparison-modal-title'>üìä Add Stocks to Compare</h2>
                <button class='close-modal' onclick='MarketData.closeComparisonModal()' aria-label='Close dialog'>
                    <i class='fas fa-times' aria-hidden='true'></i>
                </button>
            </div>
            <div class='modal-body'>
                <form class='comparison-form' onsubmit='event.preventDefault(); MarketData.loadComparison();'>
                    <div class='form-group'>
                        <label for='comparisonSymbols'>Enter stock symbols (comma-separated):</label>
                        <input type='text' id='comparisonSymbols' class='form-input' placeholder='e.g., AAPL, MSFT, GOOGL, TSLA' required>
                        <small>You can compare up to 5 stocks at once</small>
                    </div>
                    
                    <div class='comparison-quick-presets'>
                        <label>Quick Presets:</label>
                        <button type='button' class='preset-btn' onclick='document.getElementById("comparisonSymbols").value="AAPL,MSFT,GOOGL,META,AMZN"'>
                            <i class='fas fa-laptop-code'></i> Big Tech (FAANG)
                        </button>
                        <button type='button' class='preset-btn' onclick='document.getElementById("comparisonSymbols").value="BTC-USD,ETH-USD,BNB-USD,ADA-USD"'>
                            <i class='fab fa-bitcoin'></i> Top Cryptocurrencies
                        </button>
                        <button type='button' class='preset-btn' onclick='document.getElementById("comparisonSymbols").value="^GSPC,^DJI,^IXIC,^FTSE"'>
                            <i class='fas fa-chart-line'></i> Major Indices
                        </button>
                    </div>
                    
                    <div class='form-actions'>
                        <button type='submit' class='btn btn-create'>
                            <i class='fas fa-chart-bar'></i> Load Comparison
                        </button>
                        <button type='button' class='btn btn-cancel' onclick='MarketData.closeComparisonModal()'>
                            <i class='fas fa-times'></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ‚úÖ CORRIG√â : Modal pour Create Alert -->
    <div id='modalCreateAlert' class='modal' role='dialog' aria-labelledby='alert-modal-title' aria-modal='true'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2 id='alert-modal-title'>üîî Create Price Alert</h2>
                <button class='close-modal' onclick='MarketData.closeAlertModal()' aria-label='Close dialog'>
                    <i class='fas fa-times' aria-hidden='true'></i>
                </button>
            </div>
            <div class='modal-body'>
                <form class='alert-form' onsubmit='event.preventDefault(); MarketData.createAlert();'>
                    <div class='form-group'>
                        <label for='alertSymbol'>Stock Symbol:</label>
                        <input type='text' id='alertSymbol' class='form-input' placeholder='e.g., AAPL' required>
                    </div>
                    
                    <div class='form-group'>
                        <label for='alertPrice'>Target Price (USD):</label>
                        <input type='number' id='alertPrice' class='form-input' placeholder='e.g., 150.00' step='0.01' min='0' required>
                    </div>
                    
                    <div class='form-group'>
                        <label for='alertType'>Alert Type:</label>
                        <select id='alertType' class='form-input'>
                            <option value='above'>Alert when price goes ABOVE target</option>
                            <option value='below'>Alert when price goes BELOW target</option>
                        </select>
                    </div>
                    
                    <div class='form-group'>
                        <label for='alertNote'>Note (optional):</label>
                        <textarea id='alertNote' class='form-input' rows='3' placeholder='Add a personal note for this alert...'></textarea>
                    </div>
                    
                    <div class='form-actions'>
                        <button type='submit' class='btn btn-create'>
                            <i class='fas fa-bell'></i> Create Alert
                        </button>
                        <button type='button' class='btn btn-cancel' onclick='MarketData.closeAlertModal()'>
                            <i class='fas fa-times'></i> Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Search Help Modal -->
    <div id='modalSearchHelp' class='modal' role='dialog' aria-labelledby='search-help-title' aria-modal='true'>
        <div class='modal-content'>
            <div class='modal-header'>
                <h2 id='search-help-title'>üîç How to Search Stocks</h2>
                <button class='close-modal' onclick='closeModal("modalSearchHelp")' aria-label='Close dialog'>
                    <i class='fas fa-times' aria-hidden='true'></i>
                </button>
            </div>
            <div class='modal-body'>
                <h3>üìä Symbol Format</h3>
                <p>Enter the <strong>stock ticker symbol</strong> to retrieve market data:</p>
                <ul>
                    <li><strong>US Stocks:</strong> AAPL, MSFT, GOOGL, TSLA</li>
                    <li><strong>Indices:</strong> ^GSPC (S&P 500), ^DJI (Dow Jones), ^IXIC (NASDAQ)</li>
                    <li><strong>Crypto:</strong> BTC-USD, ETH-USD</li>
                    <li><strong>European Stocks:</strong> AIR.PA (Airbus), MC.PA (LVMH)</li>
                </ul>
                
                <h3>üìà Available Data</h3>
                <ul>
                    <li>Real-time price and change</li>
                    <li>Historical price charts</li>
                    <li>Technical indicators (RSI, MACD, Bollinger Bands)</li>
                    <li>Trading volume</li>
                    <li>Key statistics (P/E ratio, market cap, etc.)</li>
                </ul>
                
                <div class='info-box'>
                    üí° <strong>Pro Tip:</strong> Use the time period buttons to analyze different timeframes and spot trends!
                </div>
            </div>
        </div>
    </div>
    
    <!-- ============================================
        CACHE MONITORING WIDGET
        ============================================ -->
    <div id='cacheWidget' class='cache-widget'>
        <button class='cache-toggle-btn' onclick='toggleCachePanel()' aria-label='Toggle cache statistics panel'>
            <i class='fas fa-database' aria-hidden='true'></i>
            <span class='cache-badge' id='cacheBadge' aria-label='Number of cached entries'>0</span>
        </button>
    </div>
    
    <!-- Screen reader only class -->
    <style>
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }
        
        /* ===== ‚úÖ CORRIG√â : Texte blanc forc√© dans info-box ===== */
        .info-box-white-text,
        .info-box-white-text h4,
        .info-box-white-text p {
            color: white !important;
        }
        
        .info-box-white-text h4 i {
            color: white !important;
        }
        
        /* ===== ‚úÖ CORRIG√â : Texte blanc dans simulation-management ===== */
        .simulation-management,
        .simulation-management .label,
        .simulation-management .value {
            color: white !important;
        }
        
        [data-theme="dark"] .simulation-management .label,
        [data-theme="dark"] .simulation-management .value {
            color: white !important;
        }
        
        /* ===== ‚úÖ NOUVEAU : Accord√©on pour Company Profile ===== */
        .company-accordion {
            margin-bottom: var(--spacing-md);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            overflow: hidden;
            background: var(--background-primary);
        }
        
        .accordion-header {
            background: var(--background-secondary);
            padding: var(--spacing-md) var(--spacing-lg);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: var(--text-primary);
            transition: all var(--transition-base);
            user-select: none;
        }
        
        .accordion-header:hover {
            background: var(--background-tertiary);
        }
        
        .accordion-header i.fa-chevron-down {
            transition: transform var(--transition-base);
            color: var(--primary-color);
        }
        
        .accordion-header.active i.fa-chevron-down {
            transform: rotate(180deg);
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .accordion-content.active {
            max-height: 3000px;
            transition: max-height 0.5s ease-in;
        }
        
        .accordion-body {
            padding: var(--spacing-lg);
        }
    </style>

    <!-- Scripts - ORDRE IMPORTANT -->
    <script src='assets/js/config.js'></script>
    <script src='assets/js/api-client.js'></script>
    <script src='assets/js/dark-mode.js'></script>
    <script src='assets/js/common.js'></script>
    <script src='assets/js/sidebar.js'></script>
    
    <!-- ‚úÖ Portfolio Manager (DOIT √™tre charg√© AVANT market-data.js) -->
    <script src='assets/js/portfolio-manager.js'></script>
    
    <!-- Market Data Script -->
    <script src='assets/js/market-data.js'></script>
</body>
</html>